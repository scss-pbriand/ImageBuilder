@page "/image-asset-uploader"

<PageTitle>Image Asset Uploader</PageTitle>

<div class="container mt-4">
    <h1>Upload Image Assets</h1>
    <DataGrid TItem="ImageAsset" Data="imageAssets" AutoGenerateColumns="false">
        <DataGridColumns>
            <DataGridColumn Field="@nameof(ImageAsset.Name)" Caption="Name" />
            <DataGridColumn Field="@nameof(ImageAsset.FilePath)" Caption="File Path" />
            <DataGridCommandColumn>
                <CommandButton Text="Delete" Clicked="DeleteImageAsset" />
            </DataGridCommandColumn>
        </DataGridColumns>
    </DataGrid>

    <FileEdit OnChange="UploadImageAsset" />
</div>

@code {
    private List<ImageAsset> imageAssets = new();

    private async Task UploadImageAsset(FileChangedEventArgs e)
    {
        foreach (var file in e.Files)
        {
            var imageAsset = new ImageAsset
            {
                Id = Guid.NewGuid(),
                Name = file.Name,
                FilePath = $"/uploads/{file.Name}",
                CreatedAt = DateTime.UtcNow
            };

            imageAssets.Add(imageAsset);

            // TODO: Save the file to the server
        }
    }

    private void DeleteImageAsset(ImageAsset imageAsset)
    {
        imageAssets.Remove(imageAsset);
    }
}