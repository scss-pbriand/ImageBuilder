@page "/image-category-manager"

<PageTitle>Image Category Manager</PageTitle>

<div class="container mt-4">
    <h1>Manage Image Categories</h1>
    <DataGrid TItem="ImageCategory" Data="imageCategories" AutoGenerateColumns="false">
        <DataGridColumns>
            <DataGridColumn Field="@nameof(ImageCategory.Name)" Caption="Name" />
            <DataGridColumn Field="@nameof(ImageCategory.ProbabilityWeight)" Caption="Probability Weight" />
            <DataGridCommandColumn>
                <CommandButton Text="Edit" Clicked="EditImageCategory" />
                <CommandButton Text="Delete" Clicked="DeleteImageCategory" />
            </DataGridCommandColumn>
        </DataGridColumns>
    </DataGrid>

    <Button Color="Color.Primary" Clicked="AddImageCategory">Add New Image Category</Button>

    <Modal IsVisible="isModalVisible" OnClosed="CloseModal">
        <ModalHeader>Add/Edit Image Category</ModalHeader>
        <ModalBody>
            <TextEdit @bind-Value="currentImageCategory.Name" Placeholder="Enter Category Name" />
            <NumericEdit @bind-Value="currentImageCategory.ProbabilityWeight" Placeholder="Enter Probability Weight" />
        </ModalBody>
        <ModalFooter>
            <Button Color="Color.Primary" Clicked="SaveImageCategory">Save</Button>
            <Button Color="Color.Secondary" Clicked="CloseModal">Cancel</Button>
        </ModalFooter>
    </Modal>
</div>

@code {
    private List<ImageCategory> imageCategories = new();
    private ImageCategory currentImageCategory = new();
    private bool isModalVisible;

    private void AddImageCategory()
    {
        currentImageCategory = new ImageCategory();
        isModalVisible = true;
    }

    private void EditImageCategory(ImageCategory imageCategory)
    {
        currentImageCategory = imageCategory;
        isModalVisible = true;
    }

    private void DeleteImageCategory(ImageCategory imageCategory)
    {
        imageCategories.Remove(imageCategory);
    }

    private void SaveImageCategory()
    {
        if (!imageCategories.Contains(currentImageCategory))
        {
            imageCategories.Add(currentImageCategory);
        }
        isModalVisible = false;
    }

    private void CloseModal()
    {
        isModalVisible = false;
    }
}